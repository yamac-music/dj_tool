DJ Utility App "DJ Toolkit" 要件定義書・基本設計書1. プロジェクト概要1.1. 目的現場のDJがプレイ中に必要とする情報を、最小限の操作と視線移動で確認できるiOSアプリケーションを開発します。既存アプリの複雑さを排除し、「タイムマネジメント」「ジャンル移行時のBPM計算」「音圧監視」の3機能に特化します。1.2. ターゲットユーザークラブやイベント現場でプレイするDJタイムキーピングを厳密に行うプロフェッショナルBPMの異なるジャンル（例：UK GarageからDrum & Bass）をミックスするDJ2. 機能要件 (Functional Requirements)2.1. タイムマネジメント機能 (Time Manager)本アプリの最優先機能です。カウントダウンタイマー設定した時間から0に向かって減算します。プリセット設定「30分」「45分」「60分」のボタンタップで、即座にタイマー時間を設定・リセットします。手動調整「+1分」「-1分」ボタンにより、プレイ中いつでも時間を微調整します。視覚的アラート残り時間が5分（300秒）未満で、タイマー表示色を「赤（Danger Color）」に変更します。プログレスバーにより、全持ち時間に対する経過時間を可視化します。2.2. BPMトランジション計算機能 (BPM Calculator)UK Garage (UKG) などから Drum & Bass (DnB) への移行を支援します。基準BPM設定スライダー操作により数値を大まかに変更します（範囲: 70-180）。「+」「-」ボタンにより数値を1単位ずつ変更します。ループ計算ロジック3/4 Loop: 基準BPMを3拍ループさせた際の、4/4拍子換算のBPMを算出します（係数: 1.333...）。1/2 Loop: 基準BPMを2拍ループさせた際の、倍速BPMを算出します（係数: 2.0）。リアルタイム反映基準BPMの変更に合わせ、ターゲットBPMを即座に再計算し表示します。2.3. 音圧モニタリング機能 (Room Level)フロアの音量状況を簡易的に把握します。dB取得デバイスのマイク入力を使用し、現在の音圧レベル（デシベル）を取得します。数値表示取得した値をリアルタイムでデジタル表示します。警告表示100dB超過時、数値の色を赤に変更し、聴覚保護を警告します。3. 非機能要件 (Non-Functional Requirements)3.1. UI/UX要件Dark Mode Native: 暗いDJブースでの使用を前提とし、背景色は完全な黒（#000000）を採用します。One-Hand Operation: 全ての主要操作を片手（特に親指）で行える配置とします。High Contrast: 視認性確保のため、シアン（#06b6d4）、マゼンタ（#d946ef）、白（#ffffff）のネオンカラーを使用します。誤操作防止: スワイプなどのジェスチャーに依存せず、明確なボタンタップにより動作させます。3.2. プラットフォーム要件OS: iOS 17.0以上Device: iPhone 15 Pro以降の画面サイズに最適化します（他モデルでもレイアウト崩れ不可）。Orientation: 縦画面（Portrait）固定とします。4. 画面設計 (UI Design Specification)画面全体を縦に3分割し、重要度に応じた面積配分を行います。4.1. ヘッダーエリア (Top Bar)高さ: 画面高の約5%要素: アプリタイトル "DJ TOOLKIT"、バッテリー残量アイコン。4.2. メインエリア: Time Manager高さ: 画面高の約55%（最重要エリア）背景: 黒 (#000000) または濃いグレー (#030712)構成要素:プリセットボタン列 (右上):[30m], [45m], [60m]スタイル: 角丸四角、非アクティブ時はグレー、タップ時は瞬時にフィードバック。メインタイマー表示 (中央):フォーマット: MM:SS (例: 45:00)サイズ: 画面幅の90%を使用する特大フォント（約160-180pt）。フォント: 等幅（Monospace/Tabular nums）を使用し、桁数変化による揺れを防ぎます。プログレスバー:タイマー直下に配置。初期時間を100%とし、残量に応じて幅を減らします。色: 通常時はシアン、残り5分未満で赤。コントロール群 (下部):[-] ボタン: 左側配置、円形。[▶︎/II] ボタン: 中央配置、最大サイズ、円形。再生中はアイコンを一時停止に変更。[+] ボタン: 右側配置、円形。[Reset] ボタン: 右端下部に小さく配置。4.3. サブエリア: BPM Calculator高さ: 画面高の約25%背景: 黒 (#000000)構成要素:BASE BPM (左側):現在値表示（大）。左右に [-] [+] ボタン。下部にスライダー（シークバー）。Loop Select (中央):[3/4 Loop], [1/2 Loop] ボタンを縦並び配置。選択中のモードをハイライト（枠線および背景色変更）。TARGET BPM (右側):計算結果数値（特大）。マゼンタ色で強調。ラベル "TARGET BPM"。4.4. フッターエリア: Room Level高さ: 画面高の約15%背景: ダークグレー (#111827) で区分け。構成要素:左寄せ: 波形アイコン + ラベル "ROOM LEVEL"右寄せ: 数値 "86" (特大) + 単位 "dB" (小)5. 技術スタック (Technology Stack)Framework: React Native (Expo SDK 50+)Language: TypeScriptUI Library: React Native Built-in Components (View, Text, TouchableOpacity) + Lucide React Native (Icons)Styling: Tailwind CSS (NativeWind)Audio Processing: react-native-audio-recorder-player または Expo Audio API (マイク入力レベル取得用)6. ロジック仕様 (Logic Specifications)6.1. BPM計算式TargetBPM = Round(BaseBPM * (4 / LoopNumerator))
3/4 Loop: BaseBPM * (4/3) ≈ BaseBPM * 1.3331/2 Loop: BaseBPM * (4/2) = BaseBPM * 2.0計算結果は Math.round() で四捨五入し、整数表示します。6.2. タイマー状態管理状態変数: timeLeft (残り秒数), initialTime (設定持ち時間), isRunning (計測中フラグ)調整ロジック:+ ボタン: timeLeft に60秒加算します。- ボタン: timeLeft から60秒減算しまsす（0未満防止）。調整操作は initialTime に影響を与えません（プログレスバー分母固定）。例外: リセット直後（開始前）の調整時は initialTime も更新します。6.3. dB値シミュレーション（MVPフェーズ）オーディオAPI実装前またはマイク権限拒否時は、85dB〜105dB範囲のランダム変動値を表示するフォールバック機能を実装します。